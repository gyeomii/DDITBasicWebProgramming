<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/outStyle.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
  <div class="col-md-3">
     <select class="form-control" id="lprod">
<!--       <option>lprod리스트</option> -->
    </select>
  </div>
  <div class="col-md-3">
    <select class="form-control" id="prod">
<!--       <option>prod리스트</option> -->
    </select>
  </div>
  <br><br>
  <div>prod의 상세정보</div>

<script>

// 제이쿼리로 ajax - lprod 
$.ajax({
	url: 'lprod.jsp',	//json obj arr
// 	type:get,
	success:function(data){
	  //select id영역에 뿌려주기..
	  let rst = "";
	  $.each(data,function(i){
		rst += `<option value='${data[i].lprod_gu}'>${data[i].lprod_nm}</option>`;
	  });
	  $('#lprod').append(rst);	
	},
	error:function(xhr){
		alert(xhr.status);
	},
	dataType: 'json'
});

//자바스크립트로 ajax - lprod
//숙제

// 제이쿼리로 ajax - prod
$('#lprod').on('change',function(){
	
	//console.log( $(this).val() ); //요청정보
	$.ajax({
		url : 'prod2.jsp',
		data : {'lprod_gu' : $(this).val()},
		success:function(data){
			let code = ``;
			if(data.code == "ok"){
			  $.each(data.value, function(i,v){
				code += `<option value='${v.prodId}'>${this.prodNm}</option>`;
			  });
			  $('#prod').html(code);	
			}else{	//데이터 없을 때
			  code += `<option value='0'>데이터 없음</option>`;
			  $('#prod').html(code);	
			}
		},
		error:function(xhr){
			alert(xhr.status);
		},
		dataType: 'json'
	});
});
</script>
</body>
</html>