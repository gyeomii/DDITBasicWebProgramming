<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/outStyle.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<script src="../js/jquery-3.6.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="col-md-3">
		<select class="form-control" id="lprod">
			<option value='0'></option>
		</select>
	</div>

	<div class="col-md-3">
		<select class="form-control" id="prod">
		</select>
	</div>

	<br><br>
	
	<div>prod의 상세정보</div>
<script>
//js로 ajax - lprod
let lprodSel = document.getElementById('lprod');
lprodSel.addEventListener('change', function(){
	let req = new XMLHttpRequest();
	req.open('get', 'lprod.jsp');
	req.send();
	req.onreadystatechange = function(){
		if(this.readyState == 4 && this.status == 200){
			let data = JSON.parse(this.responseText);
			let result = ``;
			
			for(let i = 0; i <data.length; i++){
				result += `<option value='${data[i].lprod_gu}'>${data[i].lprod_nm}</option>`;
			}
			lprodSel.append(result);
		}
	}
});

//js로 ajax - prod
let prodSel = document.getElementById('prod');
prodSel.addEventListener('change', function(){
	let req = new XMLHttpRequest();
	req.open('get', 'prod.jsp');
	req.send();
	req.onreadystatechange = function(){
		if(this.readyState == 4 && this.status == 200){
			let data = JSON.parse(this.responseText);
			let result = ``;
			if(data.code == "ok"){				
				for(let i = 0; i < data.length; i++){
					result += `<option value='${data[i].prodId}'>${data[i].prodNm}</option>`;
				}
			}else{
				resut += `<option value='${v.prodId}'>${this.prodNm}</option>`;
			}
			prodSel.append(result);
		}
	}
});
</script>
</body>
</html>