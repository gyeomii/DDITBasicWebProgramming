<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/outStyle.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<script src="../js/jquery-3.6.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="col-md-3">
		<select class="form-control" id="lprod">
			<option value='0'></option>
		</select>
	</div>

	<div class="col-md-3">
		<select class="form-control" id="prod">
			<option value='0'></option>
		</select>
	</div>

	<br><br>
	
	<div>prod의 상세정보</div>
<script>
//js로 ajax - lprod
let lprodSel = document.getElementById('lprod');
window.onload = function(){
	let req = new XMLHttpRequest();
	req.open('get', './jsp/lprod_JSON.jsp');
	req.send();
	req.onreadystatechange = function(){
		if(this.readyState == 4 && this.status == 200){
			let data = JSON.parse(this.responseText);
			let result = ``;
			
			for(let i = 0; i <data.length; i++){
				result += `<option value='${data[i].lprod_gu}'>${data[i].lprod_nm}</option>`;
			}
			lprodSel.innerHTML = result;
		}
	}
};

//js로 ajax - prod
let prodSel = document.getElementById('prod');
lprodSel.addEventListener('change', function(){ //event 바꿔보기
	let req = new XMLHttpRequest();
	req.open('get', './jsp/prod.jsp');
	req.send();
	req.onreadystatechange = function(){
		if(this.readyState == 4 && this.status == 200){
			let data = JSON.parse(this.responseText);
			let result = ``;
			
			if(data.code == "ok"){				
				for(let i = 0; i < data.length; i++){
					result += `<option value='${this.prodId}'>${this.prodNm}</option>`;
				}
			}else{
				result += `<option>데이터 없음</option>`;
			}
			prodSel.innerHTML = result;
		}
	}
});
</script>
</body>
</html>