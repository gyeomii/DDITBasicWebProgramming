<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>회원가입 페이지</title>
<link rel="stylesheet" href="../css/outStyle.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- <script src="../js/jquery-3.6.0.min.js"></script> -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<style>
	h2{
		
	}
</style>
</head>
<body>
  <div class="container">
  <h2>회원가입</h2>
  <form class="form-horizontal" method="post" onsubmit="return false;">
    
    <div class="form-group">
      <label for="id" class="control-label col-sm-2">아이디</label>
      <span class="sp"></span>
      <div class="col-sm-3">
        <input type="text" class="form-control" id="id" placeholder="영문숫자 혼용 최대 8자리" name="mem_id" required pattern="[a-zA-Z][a-zA-Z0-9]{3,7}">
      </div>
<!--       <button type="button" class="btn btn-sm btn-success" id="idChk">중복검사</button> -->
	    <span id="rst"></span>
    </div>
    
    <div class="form-group">
      <label for="name" class="control-label col-sm-2">이름</label>
      <span class="sp"></span>
      <div class="col-sm-3">
        <input type="text" class="form-control" id="name" placeholder="한글 최대8자리" name="mem_name" required pattern="[가-힣]{2,8}">
      </div>
    </div>
    
    <div class="form-group">
      <label for="bir" class="control-label col-sm-2">생년월일</label>
      <div class="col-sm-3">
        <input type="date" class="form-control" id="bir" name="mem_bir" required>
        <span class="sp"></span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="pass" class="control-label col-sm-2">비밀번호</label>
      <div class="col-sm-3">
        <input type="password" class="form-control" id="pass" placeholder="4 ~ 8자리 영어 대소문자 + 숫자" name="mem_pass" required pattern="^(?=.*?[a-z])(?=.*?[A-Z])(?=.*?[0-9])[a-zA-Z0-9]{4,8}">
      </div>
      <span class="sp"></span>
    </div>
    
    <div class="form-group">
      <label for="hp" class="control-label col-sm-2">휴대전화</label>
      <div class="col-sm-3">
        <input type="text" class="form-control" id="hp" name="mem_hp" placeholder="010-0000-0000" required pattern="^010-?([0-9]{3,4})-?([0-9]{4})">
      </div>
      <span class="sp"></span>
    </div>
    
    <div class="form-group">
      <label for="mail" class="control-label col-sm-2">이메일</label>
      <div class="col-sm-3">
        <input type="email" class="form-control" id="mail" name="mem_mail">
      </div>
      <span class="sp"></span>
    </div>
    
    <div class="form-group">
      <label for="zip" class="control-label col-sm-2">우편번호</label>
      <div class="col-sm-3">
        <input type="text" class="form-control" id="zip" name="mem_zip">
      </div>
      <button type="button" id="btn" class="btn btn-info">우편검색</button>
    </div>
    
    <div class="form-group">
      <label for="add1" class="control-label col-sm-2">주소</label>
      <div class="col-sm-6">
        <input type="text" class="form-control" id="add1" name="mem_add1">
      </div>
    </div>
    
    <div class="form-group">
      <label for="add2" class="control-label col-sm-2">상세주소</label>
      <div class="col-sm-6">
        <input type="text" class="form-control" id="add2" name="mem_add2">
      </div>
    </div>
    
    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-6">
        <button type="submit" class="btn btn-primary"> 전송</button>
        <span id="joinspan"></span>
      </div>
    </div>
  </form>
  
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <p>동(읍/면) 입력</p>
          <input id="dong" class="form-control">
          <input type="button" id="btnDong" value="검색" class="btn btn-success">
          <div id="result"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
  <!-- Modal end -->
  </div>
  
<script>
//$('#idChk').on('click',function(){});
$('#id').on('keyup',function(){
  //id중복검사
	$.ajax({
		url : 'idCheck.jsp',
	// 	type : 'get',
		data : { 'id' : $('#id').val() },
		success:function(data){
			if(data.code == "ok"){
				$('#rst').html(data.msg).css('color','green');
			}else{
			  	$('#rst').html(data.msg).css('color','red');
			}
		},
		error:function(xhr){
			alert(xhr.status);
		},
		dataType: 'json'
	});
});
 //modal띄우기 1 - 속성 사용하기
 //modal띄우기 2 - modal()사용
$('#btn').on('click',function(){
	$('#myModal').modal({backdrop: 'static'});	//검은배경 유지
// $('#myModal').modal({backdrop: true});		//default, 검은배경 닫힘
// $('#myModal').modal();						//default, 검은배경 닫힘
// $('#myModal').modal({backdrop: false});		//투명배경 유지
});  

// 우편번호 찾기
$('#btnDong').on('click',function(){
	$.ajax({
		url : 'dongSearch.jsp',
		data : {'dong' : $('#dong').val()},
		success:function(data){
			let code = `<table border='1' class='table table-hover'>`;
				code += `<tr>`;
				code += `<th>우편번호</th>`;
				code += `<th>주소</th>`;
				code += `<th>번지</th>`;
				code += `</tr>`;
				
			$.each(data, function(i){
				code += `<tr class='ziptr'><td>${data[i].zipCode}</td>`;
				code += `<td>${this.addr}</td>`;
				code += `<td>${this.bunji}</td></tr>`;
			});
				code += `</table>`;
			$('#result').html(code);
		},
		error:function(xhr){
			alert(xhr.status);
		},
		dataType : 'json'
	});
});

// delegate방식으로 동적요소 선택 이벤트 부여
//$(parentSel).on('event', 'childSel', fn)
$('#result').on('click', '.ziptr', function(){
	let zipCd = $('td:eq(0)',this).text();
	let addr = $('td:eq(1)',this).text();
	$('#zip').val(zipCd);
	$('#add1').val(addr);
	//영역 초기화
	$('#dong').val("");
	$('#result').empty();
	//모달창 숨기기
	$('#myModal').modal('hide');
});
</script>  
</body>
</html>